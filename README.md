# Stock Analysis Dashboard - Hackathon Project

A full-stack serverless application that allows users to upload their stock portfolio CSV files and receive real-time financial news analysis generated by an n8n workflow.

## 🚀 Features

- **Google Authentication**: Secure login with Firebase Auth
- **CSV Upload**: Drag-and-drop CSV file upload to Firebase Storage
- **Real-time Analysis**: Live updates of analysis results via Firestore
- **Modern UI**: Clean, responsive interface built with React and Tailwind CSS
- **Serverless Backend**: Firebase Cloud Functions for processing
- **n8n Integration**: Webhook-based workflow triggering

## 🏗️ Architecture

```
Frontend (React + Vite + Tailwind)
    ↓
Firebase Auth (Google Sign-in)
    ↓
Firebase Storage (CSV Upload)
    ↓
Cloud Function (CSV Processing)
    ↓
n8n Webhook (Analysis Workflow)
    ↓
Cloud Function (Results Storage)
    ↓
Firestore (Real-time Updates)
    ↓
Frontend (Live Results Display)
```

## 📁 Project Structure

```
├── frontend/                 # React frontend application
│   ├── src/
│   │   ├── components/      # Reusable UI components
│   │   ├── contexts/        # React contexts (Auth)
│   │   ├── pages/          # Page components
│   │   ├── firebaseConfig.js
│   │   └── ...
│   ├── package.json
│   └── ...
├── functions/              # Firebase Cloud Functions
│   ├── index.js           # Main function logic
│   └── package.json
├── firebase.json          # Firebase configuration
├── firestore.rules       # Firestore security rules
├── storage.rules        # Storage security rules
└── README.md
```

## 🛠️ Setup Instructions

### Prerequisites

- Node.js 18+ installed
- Firebase CLI installed (`npm install -g firebase-tools`)
- Firebase project created
- n8n instance with webhook endpoint

### 1. Firebase Setup

1. Create a new Firebase project at [Firebase Console](https://console.firebase.google.com/)
2. Enable the following services:
   - Authentication (Google Sign-in)
   - Firestore Database
   - Storage
   - Cloud Functions

3. Install Firebase CLI and login:
   ```bash
   npm install -g firebase-tools
   firebase login
   ```

4. Initialize Firebase in your project:
   ```bash
   firebase init
   ```
   Select: Functions, Firestore, Storage, and Emulators

### 2. Environment Configuration

1. **Frontend Environment Variables**:
   Create `frontend/.env` file:
   ```env
   VITE_FIREBASE_API_KEY=your_api_key_here
   VITE_FIREBASE_AUTH_DOMAIN=your_project_id.firebaseapp.com
   VITE_FIREBASE_PROJECT_ID=your_project_id
   VITE_FIREBASE_STORAGE_BUCKET=your_project_id.appspot.com
   VITE_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
   VITE_FIREBASE_APP_ID=your_app_id
   ```

2. **Cloud Functions Configuration**:
   Set the n8n webhook URL:
   ```bash
   firebase functions:config:set n8n.webhook_url="https://your-n8n-instance.com/webhook/your-webhook-id"
   ```

### 3. Installation

1. Install all dependencies:
   ```bash
   npm run install-all
   ```

2. Or install separately:
   ```bash
   # Frontend dependencies
   cd frontend && npm install
   
   # Functions dependencies
   cd functions && npm install
   ```

### 4. Development

1. **Start Firebase Emulators** (for local development):
   ```bash
   firebase emulators:start
   ```

2. **Start Frontend Development Server**:
   ```bash
   cd frontend && npm run dev
   ```

3. **Deploy Functions** (when ready for production):
   ```bash
   npm run deploy-functions
   ```

## 🔧 Configuration

### Firebase Security Rules

The project includes security rules for:
- **Firestore**: Users can only access their own analysis results
- **Storage**: Users can only upload to their own portfolio folder

### n8n Webhook Integration

The Cloud Function expects your n8n webhook to:
1. Receive POST requests with `{ userId, csvData }` payload
2. Process the CSV data and generate analysis results
3. Send results back to the `receiveAnalysisResults` function

Expected n8n webhook response format:
```json
{
  "userId": "user123",
  "results": [
    {
      "ticker": "AAPL",
      "headline": "Apple Reports Strong Q4 Earnings",
      "source": "Financial Times",
      "article_url": "https://example.com/article",
      "analysis": {
        "summary": "Positive earnings report with strong revenue growth",
        "sentiment": "Positive",
        "impact_score": 85,
        "reasoning": "Revenue exceeded expectations by 15%"
      }
    }
  ]
}
```

## 🚀 Deployment

1. **Deploy Firebase Functions**:
   ```bash
   firebase deploy --only functions
   ```

2. **Deploy Security Rules**:
   ```bash
   firebase deploy --only firestore:rules,storage:rules
   ```

3. **Build and Deploy Frontend**:
   ```bash
   cd frontend
   npm run build
   # Deploy to your preferred hosting platform (Vercel, Netlify, etc.)
   ```

## 📊 Usage

1. **User Authentication**: Users sign in with Google
2. **CSV Upload**: Upload a CSV file with stock portfolio data
3. **Real-time Analysis**: View live analysis results as they're processed
4. **Results Display**: See sentiment analysis, impact scores, and summaries

## 🔍 API Endpoints

### Cloud Functions

- `processPortfolioCSV`: Triggered automatically on CSV upload
- `manualProcessCSV`: Manual CSV processing endpoint
- `receiveAnalysisResults`: Receives results from n8n workflow

## 🛡️ Security Features

- Firebase Authentication with Google Sign-in
- Firestore security rules restricting data access
- Storage security rules for file uploads
- User-specific data isolation

## 🧪 Testing

1. **Local Testing**: Use Firebase emulators for local development
2. **Function Testing**: Test functions with Firebase Functions shell
3. **Integration Testing**: Test complete workflow with real n8n instance

## 📝 Notes

- The application automatically clears previous results when a new file is uploaded
- CSV files are processed asynchronously via Cloud Functions
- Real-time updates are handled through Firestore listeners
- All user data is isolated by Firebase security rules

## 🤝 Contributing

This is a hackathon project. Feel free to fork and modify for your needs!

## 📄 License

MIT License - feel free to use this project for your hackathon or personal projects.
